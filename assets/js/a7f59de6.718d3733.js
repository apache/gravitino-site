"use strict";(globalThis.webpackChunkapache_website_template=globalThis.webpackChunkapache_website_template||[]).push([[58942],{95943(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>j,frontMatter:()=>a,metadata:()=>d,toc:()=>h});var l=t(13274),i=t(25709),r=t(38887),s=t(27067);const a={title:"Lance table support",slug:"/lance-table-support",keywords:["lakehouse","lance","metadata","generic catalog"],license:"This software is licensed under the Apache License version 2."},c=void 0,d={id:"lakehouse-generic-lance-table",title:"Lance table support",description:"Overview",source:"@site/docs/lakehouse-generic-lance-table.md",sourceDirName:".",slug:"/lance-table-support",permalink:"/docs/next/lance-table-support",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/gravitino-site/tree/main/docs/lakehouse-generic-lance-table.md",tags:[],version:"current",frontMatter:{title:"Lance table support",slug:"/lance-table-support",keywords:["lakehouse","lance","metadata","generic catalog"],license:"This software is licensed under the Apache License version 2."},sidebar:"docs",previous:{title:"Generic Lakehouse Catalog",permalink:"/docs/next/lakehouse-generic-catalog"},next:{title:"Iceberg catalog",permalink:"/docs/next/lakehouse-iceberg-catalog"}},o={},h=[{value:"Overview",id:"overview",level:2},{value:"Table Management",id:"table-management",level:2},{value:"Supported Operations",id:"supported-operations",level:3},{value:"Data Type Mappings",id:"data-type-mappings",level:3},{value:"External Type Support",id:"external-type-support",level:3},{value:"Table Properties",id:"table-properties",level:3},{value:"Table Operations",id:"table-operations",level:3},{value:"Creating a Lance Table",id:"creating-a-lance-table",level:4},{value:"Registering External Tables",id:"registering-external-tables",level:4},{value:"Advanced Topics",id:"advanced-topics",level:2},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Common Issues",id:"common-issues",level:4},{value:"Migration Guide",id:"migration-guide",level:3},{value:"Migrating Existing Lance Tables",id:"migrating-existing-lance-tables",level:4}];function x(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"This document describes how to use Apache Gravitino to manage a generic lakehouse catalog using Lance as the underlying table format."}),"\n",(0,l.jsx)(n.h2,{id:"table-management",children:"Table Management"}),"\n",(0,l.jsx)(n.h3,{id:"supported-operations",children:"Supported Operations"}),"\n",(0,l.jsx)(n.p,{children:"For Lance tables in a Generic Lakehouse Catalog, the following table summarizes supported operations:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Operation"}),(0,l.jsx)(n.th,{children:"Support Status"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"List"}),(0,l.jsx)(n.td,{children:"\u2705 Full"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Load"}),(0,l.jsx)(n.td,{children:"\u2705 Full"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Alter"}),(0,l.jsx)(n.td,{children:"Not support now"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Create"}),(0,l.jsx)(n.td,{children:"\u2705 Full"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Register"}),(0,l.jsx)(n.td,{children:"\u2705 Full"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Drop"}),(0,l.jsx)(n.td,{children:"\u2705 Full"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Purge"}),(0,l.jsx)(n.td,{children:"\u2705 Full"})]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"Feature Limitations",type:"note",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Partitioning:"})," Not currently supported"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Sort Orders:"})," Not currently supported"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Distributions:"})," Not currently supported"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Indexes:"})," Not currently supported"]}),"\n"]})}),"\n",(0,l.jsx)(n.h3,{id:"data-type-mappings",children:"Data Type Mappings"}),"\n",(0,l.jsx)(n.p,{children:"Lance uses Apache Arrow for table schemas. The following table shows type mappings between Gravitino and Arrow:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Gravitino Type"}),(0,l.jsx)(n.th,{children:"Arrow Type"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Struct"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Struct"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Map"})}),(0,l.jsx)(n.td,{children:"Not supported by Lance"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"List"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Array"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Boolean"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Boolean"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Byte"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Int8"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Short"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Int16"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Integer"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Int32"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Long"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Int64"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Float"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Float"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Double"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Double"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"String"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Utf8"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Binary"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Binary"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Decimal(p, s)"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Decimal(p, s)"})," (128-bit)"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Date"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Date"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Timestamp"}),"/",(0,l.jsx)(n.code,{children:"Timestamp(6)"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType withoutZone"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Timestamp(0)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Second withoutZone"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Timestamp(3)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Millisecond withoutZone"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Timestamp(9)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Nanosecond withoutZone"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Timestamp_tz"}),"/",(0,l.jsx)(n.code,{children:"Timestamp_tz(6)"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Microsecond withUtc"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Timestamp_tz(0)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Second withUtc"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Timestamp_tz(3)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Millisecond withUtc"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Timestamp_tz(9)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"TimestampType Nanosecond withUtc"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"Time"}),"/",(0,l.jsx)(n.code,{children:"Time(9)"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Time Nanosecond"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Null"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Null"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Fixed(n)"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Fixed-Size Binary(n)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Interval_year"})}),(0,l.jsx)(n.td,{children:"Not supported by Lance"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Interval_day"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Duration(Microsecond)"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"External(arrow_field_json_str)"})}),(0,l.jsx)(n.td,{children:"Any Arrow Field"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"external-type-support",children:"External Type Support"}),"\n",(0,l.jsxs)(n.p,{children:["For Arrow types not natively mapped in Gravitino, use the ",(0,l.jsx)(n.code,{children:"External(arrow_field_json_str)"})," type, which accepts a JSON string representation of an Arrow ",(0,l.jsx)(n.code,{children:"Field"}),"."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Requirements:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["JSON must conform to Apache Arrow ",(0,l.jsx)(n.a,{href:"https://github.com/apache/arrow-java/blob/ed81e5981a2bee40584b3a411ed755cb4cc5b91f/vector/src/main/java/org/apache/arrow/vector/types/pojo/Field.java#L80C1-L86C68",children:"Field specification"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"name"})," attribute must match column name exactly"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"nullable"})," attribute must match column nullability"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"children"})," array:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Empty for primitive types"}),"\n",(0,l.jsx)(n.li,{children:"Contains child field definitions for complex types (Struct, List)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Arrow Type"}),(0,l.jsx)(n.th,{children:"External Type Definition"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Large Utf8"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'External("{\\"name\\":\\"col_name\\",\\"nullable\\":true,\\"type\\":{\\"name\\":\\"largeutf8\\"},\\"children\\":[]}")'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Large Binary"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'External("{\\"name\\":\\"col_name\\",\\"nullable\\":true,\\"type\\":{\\"name\\":\\"largebinary\\"},\\"children\\":[]}")'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Large List"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'External("{\\"name\\":\\"col_name\\",\\"nullable\\":true,\\"type\\":{\\"name\\":\\"largelist\\"},\\"children\\":[{\\"name\\":\\"element\\",\\"nullable\\":true,\\"type\\":{\\"name\\":\\"int\\",\\"bitWidth\\":32,\\"isSigned\\":true},\\"children\\":[]}]}")'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Fixed-Size List"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'External("{\\"name\\":\\"col_name\\",\\"nullable\\":true,\\"type\\":{\\"name\\":\\"fixedsizelist\\",\\"listSize\\":10},\\"children\\":[{\\"name\\":\\"element\\",\\"nullable\\":true,\\"type\\":{\\"name\\":\\"int\\",\\"bitWidth\\":32,\\"isSigned\\":true},\\"children\\":[]}]}")'})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"table-properties",children:"Table Properties"}),"\n",(0,l.jsx)(n.p,{children:"Required and optional properties for tables in a Generic Lakehouse Catalog:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Property"}),(0,l.jsx)(n.th,{children:"Description"}),(0,l.jsx)(n.th,{children:"Default"}),(0,l.jsx)(n.th,{children:"Required"}),(0,l.jsx)(n.th,{children:"Since Version"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"format"})}),(0,l.jsxs)(n.td,{children:["Table format: ",(0,l.jsx)(n.code,{children:"lance"}),", currently only ",(0,l.jsx)(n.code,{children:"lance"})," is fully supported."]}),(0,l.jsx)(n.td,{children:"(none)"}),(0,l.jsx)(n.td,{children:"Yes"}),(0,l.jsx)(n.td,{children:"1.1.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"location"})}),(0,l.jsx)(n.td,{children:"Storage path for table metadata and data, Lance currently supports: S3, GCS, OSS, AZ, File, Memory and file-object-store."}),(0,l.jsx)(n.td,{children:"(none)"}),(0,l.jsx)(n.td,{children:"Conditional*"}),(0,l.jsx)(n.td,{children:"1.1.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"external"})}),(0,l.jsxs)(n.td,{children:["Whether the data directory is an external location. If it's ",(0,l.jsx)(n.code,{children:"true"}),", dropping a table will only remove metadata in Gravitino and will not delete the data directory, and purge table will delete both. For a non-external table, dropping will drop both."]}),(0,l.jsx)(n.td,{children:"false"}),(0,l.jsx)(n.td,{children:"No"}),(0,l.jsx)(n.td,{children:"1.1.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"lance.creation-mode"})}),(0,l.jsxs)(n.td,{children:["Create mode: for create table, it can be ",(0,l.jsx)(n.code,{children:"CREATE"}),", ",(0,l.jsx)(n.code,{children:"EXIST_OK"})," or ",(0,l.jsx)(n.code,{children:"OVERWRITE"}),". and it should be ",(0,l.jsx)(n.code,{children:"CREATE"})," or ",(0,l.jsx)(n.code,{children:"OVERWRITE"})," for registering tables"]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CREATE"})}),(0,l.jsx)(n.td,{children:"No"}),(0,l.jsx)(n.td,{children:"1.1.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"lance.register"})}),(0,l.jsxs)(n.td,{children:["Whether it is a register table operation. If it's ",(0,l.jsx)(n.code,{children:"true"}),", This API will not create data directory actually and it's the user's responsibility to create and manage the data directory. ",(0,l.jsx)(n.code,{children:"false"})," it will actually create a table."]}),(0,l.jsx)(n.td,{children:"false"}),(0,l.jsx)(n.td,{children:"No"}),(0,l.jsx)(n.td,{children:"1.1.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"lance.storage.xxxx"})}),(0,l.jsxs)(n.td,{children:["Any additional storage-specific properties required by Lance format (e.g., S3 credentials, HDFS configs). Replace ",(0,l.jsx)(n.code,{children:"xxxx"})," with actual property names. For example, we can use ",(0,l.jsx)(n.code,{children:"lance.storage.aws_access_key_id"})," to set S3 aws_access_key_id when using a S3 location, for detail, please refer to ",(0,l.jsx)(n.a,{href:"https://lancedb.com/docs/storage/integrations/",children:"https://lancedb.com/docs/storage/integrations/"})]}),(0,l.jsx)(n.td,{children:"(none)"}),(0,l.jsx)(n.td,{children:"No"}),(0,l.jsx)(n.td,{children:"1.1.0"})]})]})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CREATE"}),": Create a new table, fail if the table already exists."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"EXIST_OK"}),": Create a new table if it does not exist, otherwise do nothing."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"OVERWRITE"}),": Create a new table, overwrite if the table already exists, it will delete the existing data directory first if the table is not a registered table and then create a new one."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Location Requirement:"})," Must be specified at catalog, schema, or table level. See ",(0,l.jsx)(n.a,{href:"/docs/next/lakehouse-generic-catalog#key-property-location",children:"Location Resolution"}),"."]}),"\n",(0,l.jsx)(n.p,{children:"You may also set additional properties specific to your lakehouse format or custom requirements."}),"\n",(0,l.jsx)(n.h3,{id:"table-operations",children:"Table Operations"}),"\n",(0,l.jsxs)(n.p,{children:["Table operations follow standard relational catalog patterns. See ",(0,l.jsx)(n.a,{href:"/docs/next/manage-relational-metadata-using-gravitino#table-operations",children:"Table Operations"})," for comprehensive documentation."]}),"\n",(0,l.jsx)(n.p,{children:"The following sections provide examples and important details for working with Lance tables."}),"\n",(0,l.jsx)(n.h4,{id:"creating-a-lance-table",children:"Creating a Lance Table"}),"\n",(0,l.jsxs)(r.A,{groupId:"language",queryString:!0,children:[(0,l.jsx)(s.default,{value:"shell",label:"Shell",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'curl -X POST -H "Accept: application/vnd.gravitino.v1+json" \\\n  -H "Content-Type: application/json" -d \'{\n  "name": "lance_table",\n  "comment": "Example Lance table",\n  "columns": [\n    {\n      "name": "id",\n      "type": "integer",\n      "comment": "Primary identifier",\n      "nullable": false\n    }\n  ],\n  "properties": {\n    "format": "lance",\n    "location": "/tmp/lance_catalog/schema/lance_table"\n  }\n}\' http://localhost:8090/api/metalakes/test/catalogs/generic_lakehouse_lance_catalog/schemas/schema/tables\n'})})}),(0,l.jsx)(s.default,{value:"java",label:"Java",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'Catalog catalog = gravitinoClient.loadCatalog("generic_lakehouse_lance_catalog");\nTableCatalog tableCatalog = catalog.asTableCatalog();\n\nMap<String, String> tableProperties = ImmutableMap.<String, String>builder()\n    .put("format", "lance")\n    .put("location", "/tmp/lance_catalog/schema/example_table")\n    .build();\n\ntableCatalog.createTable(\n    NameIdentifier.of("schema", "lance_table"),\n    new Column[] {\n        Column.of("id", Types.IntegerType.get(), "Primary identifier", \n                  true, false, null)\n    },\n    "Example Lance table",\n    tableProperties,\n    null,  // partitions\n    null,  // distributions\n    null,  // sortOrders\n    null   // indexes\n);\n'})})})]}),"\n",(0,l.jsx)(n.h4,{id:"registering-external-tables",children:"Registering External Tables"}),"\n",(0,l.jsx)(n.p,{children:"Register existing Lance tables without moving or copying data:"}),"\n",(0,l.jsxs)(r.A,{groupId:"language",queryString:!0,children:[(0,l.jsx)(s.default,{value:"shell",label:"Shell",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'curl -X POST -H "Accept: application/vnd.gravitino.v1+json" \\\n  -H "Content-Type: application/json" -d \'{\n  "name": "register_lance_table",\n  "comment": "Registered existing Lance table",\n  "columns": [],\n  "properties": {\n    "format": "lance",\n    "lance.register": "true",\n    "location": "/tmp/lance_catalog/schema/existing_lance_table"\n  }\n}\' http://localhost:8090/api/metalakes/test/catalogs/generic_lakehouse_lance_catalog/schemas/schema/tables\n'})})}),(0,l.jsx)(s.default,{value:"java",label:"Java",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'Catalog catalog = gravitinoClient.loadCatalog("generic_lakehouse_lance_catalog");\nTableCatalog tableCatalog = catalog.asTableCatalog();\n\nMap<String, String> registerProperties = ImmutableMap.<String, String>builder()\n    .put("format", "lance")\n    .put("lance.register", "true")\n    .put("location", "/tmp/lance_catalog/schema/existing_lance_table")\n    .build();\n\ntableCatalog.createTable(\n    NameIdentifier.of("schema", "register_lance_table"),\n    new Column[] {},  // Schema auto-detected from existing table\n    "Registered existing Lance table",\n    registerProperties,\n    null, null, null, null\n);\n'})})})]}),"\n",(0,l.jsx)(n.admonition,{title:"Registration vs Creation",type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Registration"})," (",(0,l.jsx)(n.code,{children:"lance.register: true"}),"):"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Links to existing Lance dataset or a path placeholder"}),"\n",(0,l.jsx)(n.li,{children:"Schema automatically detected from Lance metadata"}),"\n",(0,l.jsx)(n.li,{children:"Useful for importing existing datasets"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Creation"})," (default):"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Creates new Lance table from scratch"}),"\n",(0,l.jsx)(n.li,{children:"Requires column schema definition"}),"\n",(0,l.jsx)(n.li,{children:"Initializes new Lance dataset files"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"advanced-topics",children:"Advanced Topics"}),"\n",(0,l.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h4,{id:"common-issues",children:"Common Issues"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:'Issue: "Location not specified" error'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Solution: Ensure at least one level (catalog/schema/table) specifies the location property\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Issue: Permission denied errors"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Solution: Check file system permissions and credentials for the storage backend\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Issue: Table not found after registration"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Solution: Verify the location path points to a valid Lance dataset directory\n"})}),"\n",(0,l.jsx)(n.h3,{id:"migration-guide",children:"Migration Guide"}),"\n",(0,l.jsx)(n.h4,{id:"migrating-existing-lance-tables",children:"Migrating Existing Lance Tables"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Inventory"}),": List all existing Lance table locations"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Create Catalog"}),": Create Generic Lakehouse catalog pointing to root location"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Register Tables"}),": Use register operation for each table"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Verify"}),": Confirm all tables are accessible through Gravitino"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Update Clients"}),": Point applications to Gravitino metadata instead of direct Lance access"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example Migration Script:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'# List of existing Lance tables to register\ntables_to_migrate=(\n    "sales orders /data/sales/orders"\n    "sales customers /data/sales/customers"\n    "inventory products /data/inventory/products"\n)\n\n# Register each table\nfor entry in "${tables_to_migrate[@]}"; do\n    read -r schema table location <<< "$entry"\n    echo ${schema}\n    echo ${table}\n\n    curl -X POST -H "Accept: application/vnd.gravitino.v1+json" \\\n      -H "Content-Type: application/json" -d "{\n      \\"name\\": \\"${table}\\",\n      \\"comment\\": \\"Registered existing Lance table\\",\n      \\"columns\\": [],\n      \\"properties\\": {\n        \\"format\\": \\"lance\\",\n        \\"lance.register\\": \\"true\\",\n        \\"location\\": \\"${location}\\"\n      }\n    }" http://localhost:8090/api/metalakes/test/catalogs/generic_lakehouse_lance_catalog/schemas/$schema/tables\n\n    echo "Registered ${schema}.${table}"\ndone\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Other table operations (load, alter, drop, truncate) follow standard relational catalog patterns. See ",(0,l.jsx)(n.a,{href:"/docs/next/manage-relational-metadata-using-gravitino#table-operations",children:"Table Operations"})," for details."]})]})}function j(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(x,{...e})}):x(e)}},38887(e,n,t){t.d(n,{A:()=>p});var l=t(79474),i=t(13526),r=t(50864),s=t(25591),a=t(64401);const c="tabList_ruUt",d="tabItem_ncTh";var o=t(13274);function h({className:e,block:n,selectedValue:t,selectValue:l,tabValues:s}){const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),h=e=>{const n=e.currentTarget,i=a.indexOf(n),r=s[i].value;r!==t&&(c(n),l(r))},x=e=>{let n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const t=a.indexOf(e.currentTarget)+1;n=a[t]??a[0];break}case"ArrowLeft":{const t=a.indexOf(e.currentTarget)-1;n=a[t]??a[a.length-1];break}}n?.focus()};return(0,o.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:l})=>(0,o.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>a.push(e),onKeyDown:x,onClick:h,...l,className:(0,i.A)("tabs__item",d,l?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function x({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===t);return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return(0,o.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function j(e){const n=(0,s.u)(e);return(0,o.jsxs)("div",{className:(0,i.A)("tabs-container",c),children:[(0,o.jsx)(h,{...n,...e}),(0,o.jsx)(x,{...n,...e})]})}function p(e){const n=(0,a.default)();return(0,o.jsx)(j,{...e,children:(0,s.v)(e.children)},String(n))}}}]);