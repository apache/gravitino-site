"use strict";(self.webpackChunkapache_website_template=self.webpackChunkapache_website_template||[]).push([[8520],{57554:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var s=t(13274),l=t(15829);const a={title:"Apache Gravitino Trino connector - MySQL catalog",slug:"/trino-connector/catalog-mysql",keyword:"gravitino connector trino",license:"This software is licensed under the Apache License version 2."},r=void 0,i={id:"trino-connector/catalog-mysql",title:"Apache Gravitino Trino connector - MySQL catalog",description:"The MySQL catalog allows querying and creating tables in an external MySQL instance.",source:"@site/docs/trino-connector/catalog-mysql.md",sourceDirName:"trino-connector",slug:"/trino-connector/catalog-mysql",permalink:"/docs/next/trino-connector/catalog-mysql",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/gravitino-site/tree/main/docs/trino-connector/catalog-mysql.md",tags:[],version:"current",frontMatter:{title:"Apache Gravitino Trino connector - MySQL catalog",slug:"/trino-connector/catalog-mysql",keyword:"gravitino connector trino",license:"This software is licensed under the Apache License version 2."},sidebar:"docs",previous:{title:"Iceberg",permalink:"/docs/next/trino-connector/catalog-iceberg"},next:{title:"PostgreSQL",permalink:"/docs/next/trino-connector/catalog-postgresql"}},d={},c=[{value:"Requirements",id:"requirements",level:2},{value:"Create table",id:"create-table",level:2},{value:"Alter table",id:"alter-table",level:2},{value:"Select",id:"select",level:2},{value:"Update",id:"update",level:2},{value:"Delete",id:"delete",level:2},{value:"Table and Schema properties",id:"table-and-schema-properties",level:2},{value:"Basic usage examples",id:"basic-usage-examples",level:2},{value:"Creating tables and schemas",id:"creating-tables-and-schemas",level:3},{value:"Writing data",id:"writing-data",level:3},{value:"Querying data",id:"querying-data",level:3},{value:"Modify a table",id:"modify-a-table",level:3},{value:"DROP",id:"drop",level:3}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"The MySQL catalog allows querying and creating tables in an external MySQL instance.\nYou can join data between different systems like MySQL and Hive, or between two different MySQL instances by this."}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsx)(n.p,{children:"To connect to MySQL, you need:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MySQL 5.7, 8.0 or higher."}),"\n",(0,s.jsx)(n.li,{children:"Network access from the Trino coordinator and workers to MySQL. Port 3306 is the default port."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"create-table",children:"Create table"}),"\n",(0,s.jsx)(n.p,{children:"At present, the Apache Gravitino Trino connector only supports basic MySQL table creation statements, which involve fields, null allowances, comments, primary keys, indexes, default values and auto-increment."}),"\n",(0,s.jsxs)(n.p,{children:["The Gravitino Trino connector does not support ",(0,s.jsx)(n.code,{children:"CREATE TABLE AS SELECT"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"alter-table",children:"Alter table"}),"\n",(0,s.jsx)(n.p,{children:"Support for the following alter table operations:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Rename table"}),"\n",(0,s.jsx)(n.li,{children:"Add a column"}),"\n",(0,s.jsx)(n.li,{children:"Drop a column"}),"\n",(0,s.jsx)(n.li,{children:"Change a column type"}),"\n",(0,s.jsx)(n.li,{children:"Set a table property"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"select",children:"Select"}),"\n",(0,s.jsx)(n.p,{children:"The Gravitino Trino connector supports most SELECT statements, allowing the execution of queries successfully.\nCurrently, it doesn't support certain query optimizations, such as indexes and pushdowns."}),"\n",(0,s.jsx)(n.h2,{id:"update",children:"Update"}),"\n",(0,s.jsxs)(n.p,{children:["Only ",(0,s.jsx)(n.code,{children:"UPDATE"})," statements with constant assignments and predicates are supported. See also ",(0,s.jsx)(n.a,{href:"https://trino.io/docs/current/connector/mysql.html#update-limitation",children:"UPDATE limitation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"delete",children:"Delete"}),"\n",(0,s.jsxs)(n.p,{children:["If the ",(0,s.jsx)(n.code,{children:"WHERE"})," clause is specified, only the matching rows are deleted. Otherwise, all rows from the table are deleted. See also ",(0,s.jsx)(n.a,{href:"https://trino.io/docs/current/connector/mysql.html#delete-limitation",children:"DELETE limitation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"table-and-schema-properties",children:"Table and Schema properties"}),"\n",(0,s.jsx)(n.p,{children:"MySQL's schemas cannot support properties."}),"\n",(0,s.jsx)(n.p,{children:"The following are supported MySQL table properties:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property name"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default Value"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Since Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"engine"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"InnoDB"}),(0,s.jsx)(n.td,{children:"The engine that MySQL table uses."}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"0.4.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"auto_increment_offset"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"(none)"}),(0,s.jsx)(n.td,{children:"The auto increment offset for the table."}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"0.4.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"primary_key"}),(0,s.jsx)(n.td,{children:"list"}),(0,s.jsx)(n.td,{children:"(none)"}),(0,s.jsxs)(n.td,{children:["The primary keys for the table, can choose multi columns as the table primary key. All key columns must be defined as ",(0,s.jsx)(n.code,{children:"NOT NULL"}),"."]}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"1.0.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"unique_key"}),(0,s.jsx)(n.td,{children:"list"}),(0,s.jsx)(n.td,{children:"(none)"}),(0,s.jsxs)(n.td,{children:["The unique keys for the table, can choose multi columns for multi unique key. Each unique key should be defined as ",(0,s.jsx)(n.code,{children:"keyName:col1,col2"}),"."]}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"1.0.0"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"The following are supported MySQL column properties:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property name"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default Value"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Required"}),(0,s.jsx)(n.th,{children:"Since Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"auto_increment"}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"false"}),(0,s.jsx)(n.td,{children:"The auto increment column."}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"1.0.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"default"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"(none)"}),(0,s.jsx)(n.td,{children:"The default value for column."}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"1.0.0"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Currently, creating tables only supports constant default values and does not support expression default values,\nand ",(0,s.jsx)(n.code,{children:"show create table"})," also exclusively renders constant default values in its output.\nThe following are Trino type which support configuration of default values:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type name"}),(0,s.jsx)(n.th,{children:"Default Value example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"TINYINT"}),(0,s.jsx)(n.td,{children:"1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SMALLINT"}),(0,s.jsx)(n.td,{children:"1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"INT"}),(0,s.jsx)(n.td,{children:"1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"BIGINT"}),(0,s.jsx)(n.td,{children:"1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"REAL"}),(0,s.jsx)(n.td,{children:"1.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DOUBLE"}),(0,s.jsx)(n.td,{children:"1.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DECIMAL"}),(0,s.jsx)(n.td,{children:"1.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"VARCHAR"}),(0,s.jsx)(n.td,{children:"abc"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CHAR"}),(0,s.jsx)(n.td,{children:"abc"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DATE"}),(0,s.jsx)(n.td,{children:"2025-08-07"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"TIME"}),(0,s.jsx)(n.td,{children:"01:01:01"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"TIMESTAMP"}),(0,s.jsx)(n.td,{children:"2025-08-07 01:01:01 (CURRENT_TIMESTAMP)"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"basic-usage-examples",children:"Basic usage examples"}),"\n",(0,s.jsx)(n.p,{children:"You need to do the following steps before you can use the MySQL catalog in Trino through Gravitino."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a metalake and catalog in Gravitino. Assuming that the metalake name is ",(0,s.jsx)(n.code,{children:"test"})," and the catalog name is ",(0,s.jsx)(n.code,{children:"mysql_test"}),",\nthen you can use the following code to create them in Gravitino:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: application/json" \\\n-d \'{\n  "name": "test",\n  "comment": "comment",\n  "properties": {}\n}\' http://gravitino-host:8090/api/metalakes\n\ncurl -X POST -H "Content-Type: application/json" \\\n-d \'{\n  "name": "mysql_test",\n  "type": "RELATIONAL",\n  "comment": "comment",\n  "provider": "jdbc-mysql",\n  "properties": {\n    "jdbc-url": "jdbc:mysql://mysql-host:3306?useSSL=false",\n    "jdbc-user": "<username>",\n    "jdbc-password": "<password>"\n    "jdbc-driver": "com.mysql.cj.jdbc.Driver"\n  }\n}\' http://gravitino-host:8090/api/metalakes/test/catalogs\n'})}),"\n",(0,s.jsxs)(n.p,{children:["For More information about the MySQL catalog, please refer to ",(0,s.jsx)(n.a,{href:"/docs/next/jdbc-mysql-catalog",children:"MySQL catalog"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Set the value of configuration ",(0,s.jsx)(n.code,{children:"gravitino.metalake"})," to the metalake you have created, named 'test', and start the Trino container."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Use the Trino CLI to connect to the Trino container and run a query."}),"\n",(0,s.jsx)(n.p,{children:"Listing all Gravitino managed catalogs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SHOW CATALOGS;\n"})}),"\n",(0,s.jsx)(n.p,{children:"The results are similar to:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"    Catalog\n----------------\n gravitino\n jmx\n system\n mysql_test\n(4 rows)\n\nQuery 20231017_082503_00018_6nt3n, FINISHED, 1 node\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"gravitino"})," catalog is a catalog defined By Trino catalog configuration.\nThe ",(0,s.jsx)(n.code,{children:"mysql_test"})," catalog is the catalog created by you in Gravitino.\nOther catalogs are regular user-configured Trino catalogs."]}),"\n",(0,s.jsx)(n.h3,{id:"creating-tables-and-schemas",children:"Creating tables and schemas"}),"\n",(0,s.jsxs)(n.p,{children:["Create a new schema named ",(0,s.jsx)(n.code,{children:"database_01"})," in ",(0,s.jsx)(n.code,{children:"test.mysql_test"})," catalog."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE SCHEMA mysql_test.database_01;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a new table named ",(0,s.jsx)(n.code,{children:"table_01"})," in schema ",(0,s.jsx)(n.code,{children:"mysql_test.database_01"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE mysql_test.database_01.table_01\n(\nname varchar,\nsalary int\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a new table named ",(0,s.jsx)(n.code,{children:"table_index"})," in schema ",(0,s.jsx)(n.code,{children:"mysql_test.database_01"})," with primary keys and indexes."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE mysql_test.database_01.table_index (\n   key1 integer NOT NULL,\n   key2 integer,\n   key3 integer,\n   key4 integer,\n   key5 integer NOT NULL,\n   col1 integer\n)\nCOMMENT ''\nWITH (\n   engine = 'InnoDB',\n   primary_key = ARRAY['key5','key1'],\n   unique_key = ARRAY['unique_key1:key2','unique_key2:key4,key3']\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a new table named ",(0,s.jsx)(n.code,{children:"table_column_properties"})," in schema ",(0,s.jsx)(n.code,{children:"mysql_test.database_01"})," with auto_increment and default."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE mysql_test.database_01.table_column_properties(\n    key1 INT NOT NULL WITH (auto_increment=true),\n    f1 VARCHAR(200) WITH (default='VARCHAR'),\n    f2 CHAR(20) WITH (default='CHAR') ,\n    f4 DECIMAL(10, 3) WITH (default='0.3') ,\n    f5 REAL WITH (default='0.3') ,\n    f6 DOUBLE WITH (default='0.3') ,\n    f8 TINYINT WITH (default='1') ,\n    f9 SMALLINT WITH (default='1') ,\n    f10 INT WITH (default='1') ,\n    f11 INTEGER WITH (default='1') ,\n    f12 BIGINT WITH (default='1'),\n    f13 DATE WITH (default='2024-04-01'),\n    f14 TIME WITH (default='08:00:00'),\n    f15 TIMESTAMP WITH (default='2012-12-31 11:30:45'),\n    f16 TIMESTAMP WITH TIME ZONE WITH (default='2012-12-31 11:30:45'),\n    f17 TIMESTAMP WITH TIME ZONE WITH (default='CURRENT_TIMESTAMP')\n)\nWITH (\n   primary_key = ARRAY['key1']\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"writing-data",children:"Writing data"}),"\n",(0,s.jsxs)(n.p,{children:["Insert data into the table ",(0,s.jsx)(n.code,{children:"table_01"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"INSERT INTO mysql_test.database_01.table_01 (name, salary) VALUES ('ice', 12);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Insert data into the table ",(0,s.jsx)(n.code,{children:"table_01"})," from select:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'INSERT INTO mysql_test.database_01.table_01 (name, salary) SELECT * FROM "test.mysql_test".database_01.table_01;\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Update the table ",(0,s.jsx)(n.code,{children:"table_01"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"UPDATE mysql_test.database_01.table_01 SET name = 'ice_update' WHERE salary = 12;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Delete the table ",(0,s.jsx)(n.code,{children:"table_01"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DELETE FROM mysql_test.database_01.table_01 WHERE salary = 12;\nDELETE FROM mysql_test.database_01.table_01;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"querying-data",children:"Querying data"}),"\n",(0,s.jsxs)(n.p,{children:["Query the ",(0,s.jsx)(n.code,{children:"table_01"})," table:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM mysql_test.database_01.table_01;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"modify-a-table",children:"Modify a table"}),"\n",(0,s.jsxs)(n.p,{children:["Add a new column ",(0,s.jsx)(n.code,{children:"age"})," to the ",(0,s.jsx)(n.code,{children:"table_01"})," table:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE mysql_test.database_01.table_01 ADD COLUMN age int;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Drop a column ",(0,s.jsx)(n.code,{children:"age"})," from the ",(0,s.jsx)(n.code,{children:"table_01"})," table:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE mysql_test.database_01.table_01 DROP COLUMN age;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Rename the ",(0,s.jsx)(n.code,{children:"table_01"})," table to ",(0,s.jsx)(n.code,{children:"table_02"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"ALTER TABLE mysql_test.database_01.table_01 RENAME TO mysql_test.database_01.table_02;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"drop",children:"DROP"}),"\n",(0,s.jsx)(n.p,{children:"Drop a schema:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DROP SCHEMA mysql_test.database_01;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Drop a table:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DROP TABLE mysql_test.database_01.table_01;\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);