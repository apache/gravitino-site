"use strict";(globalThis.webpackChunkapache_website_template=globalThis.webpackChunkapache_website_template||[]).push([[16997],{36864(e,t,r){r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>l});var a=r(13274),s=r(25709);const i={title:"Apache Gravitino metrics",slug:"/metrics",keywords:["metrics"],license:"This software is licensed under the Apache License version 2."},o=void 0,n={id:"metrics",title:"Apache Gravitino metrics",description:"Introduction",source:"@site/versioned_docs/version-1.1.0/metrics.md",sourceDirName:".",slug:"/metrics",permalink:"/docs/1.1.0/metrics",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/gravitino-site/tree/main/docs/metrics.md",tags:[],version:"1.1.0",frontMatter:{title:"Apache Gravitino metrics",slug:"/metrics",keywords:["metrics"],license:"This software is licensed under the Apache License version 2."},sidebar:"docs",previous:{title:"Configurations",permalink:"/docs/1.1.0/gravitino-server-config"},next:{title:"How to use relational backend storage",permalink:"/docs/1.1.0/how-to-use-relational-backend-storage"}},c={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Metrics source",id:"metrics-source",level:3},{value:"HTTP server metrics",id:"http-server-metrics",level:4},{value:"JVM metrics",id:"jvm-metrics",level:4},{value:"Catalog metrics",id:"catalog-metrics",level:4}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsxs)(t.p,{children:["Apache Gravitino Metrics builds upon the ",(0,a.jsx)(t.a,{href:"https://metrics.dropwizard.io/",children:"Dropwizard Metrics"}),". It exports these metrics through both JMX and an HTTP server, supporting JSON and Prometheus formats. You can retrieve them via HTTP requests, as illustrated below:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-shell",children:"// Use Gravitino Server address or Iceberg REST server address to replace 127.0.0.1:8090\n// Get metrics in JSON format\ncurl http://127.0.0.1:8090/metrics\n// Get metrics in Prometheus format\ncurl http://127.0.0.1:8090/prometheus/metrics\n"})}),"\n",(0,a.jsx)(t.h3,{id:"metrics-source",children:"Metrics source"}),"\n",(0,a.jsx)(t.h4,{id:"http-server-metrics",children:"HTTP server metrics"}),"\n",(0,a.jsxs)(t.p,{children:["HTTP server metrics encompass the histogram of HTTP request processing time and the number of HTTP response codes, categorized by different HTTP interfaces such as ",(0,a.jsx)(t.code,{children:"create-table"})," and ",(0,a.jsx)(t.code,{children:"load-table"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["For instance, you can get Prometheus metrics for ",(0,a.jsx)(t.code,{children:"create-table"})," operation in the Gravitino server as follows:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'gravitino_server_1xx_responses_total{operation="create-table",} 0.0\ngravitino_server_4xx_responses_total{operation="create-table",} 0.0\ngravitino_server_5xx_responses_total{operation="create-table",} 0.0\ngravitino_server_2xx_responses_total{operation="create-table",} 0.0\ngravitino_server_3xx_responses_total{operation="create-table",} 0.0\ngravitino_server_http_request_duration_seconds_count{operation="create-table",} 0.0\ngravitino_server_http_request_duration_seconds{operation="create-table",quantile="0.5",} 0.0\ngravitino_server_http_request_duration_seconds{operation="create-table",quantile="0.75",} 0.0\ngravitino_server_http_request_duration_seconds{operation="create-table",quantile="0.95",} 0.0\ngravitino_server_http_request_duration_seconds{operation="create-table",quantile="0.98",} 0.0\ngravitino_server_http_request_duration_seconds{operation="create-table",quantile="0.99",} 0.0\ngravitino_server_http_request_duration_seconds{operation="create-table",quantile="0.999",} 0.0\n'})}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["Metrics with the ",(0,a.jsx)(t.code,{children:"gravitino-server"})," prefix pertain to the Gravitino server, while those with the ",(0,a.jsx)(t.code,{children:"iceberg-rest-server"})," prefix are for the Gravitino Iceberg REST server."]})}),"\n",(0,a.jsx)(t.h4,{id:"jvm-metrics",children:"JVM metrics"}),"\n",(0,a.jsxs)(t.p,{children:["JVM metrics source uses ",(0,a.jsx)(t.a,{href:"https://metrics.dropwizard.io/4.2.0/manual/jvm.html",children:"JVM instrumentation"})," with BufferPoolMetricSet, GarbageCollectorMetricSet, and MemoryUsageGaugeSet.\nThese metrics start with the ",(0,a.jsx)(t.code,{children:"jvm"})," prefix, like ",(0,a.jsx)(t.code,{children:"jvm.heap.used"})," in JSON format, ",(0,a.jsx)(t.code,{children:"jvm_heap_used"})," in Prometheus format."]}),"\n",(0,a.jsx)(t.h4,{id:"catalog-metrics",children:"Catalog metrics"}),"\n",(0,a.jsxs)(t.p,{children:["Catalog metrics provide the metrics from different catalog instances.\nAll the catalog metrics start with the ",(0,a.jsx)(t.code,{children:"gravitino-catalog"})," prefix in Prometheus format and with labels ",(0,a.jsx)(t.code,{children:"provider"}),", ",(0,a.jsx)(t.code,{children:"metalake"}),", and ",(0,a.jsx)(t.code,{children:"catalog"})," to distinguish different catalog instances."]}),"\n",(0,a.jsx)(t.p,{children:"Currently, Catalog metrics only support Fileset catalog and JDBC catalog."}),"\n",(0,a.jsxs)(t.p,{children:["You can get Prometheus metrics for a Fileset catalog named ",(0,a.jsx)(t.code,{children:"test_catalog"})," under a metalake named ",(0,a.jsx)(t.code,{children:"test_metalake"})," in the Gravitino server as follows:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'gravitino_catalog_filesystem_cache_hits{provider="fileset",metalake="test_metalake",catalog="test_catalog",} 0.0\ngravitino_catalog_filesystem_cache_misses{provider="fileset",metalake="test_metalake",catalog="test_catalog",} 0.0\n'})}),"\n",(0,a.jsxs)(t.p,{children:["You can get Prometheus metrics for a JDBC catalog named ",(0,a.jsx)(t.code,{children:"test_catalog"})," under a metalake named ",(0,a.jsx)(t.code,{children:"test_metalake"})," in the Gravitino server as follows:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'gravitino_catalog_datasource_idle_connections{provider="jdbc",metalake="test_metalake",catalog="test_catalog",} 1.0\ngravitino_catalog_datasource_active_connections{provider="jdbc",metalake="test_metalake",catalog="test_catalog",} 0.0\ngravitino_catalog_datasource_max_connections{provider="jdbc",metalake="test_metalake",catalog="test_catalog",} 10.0\n'})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);